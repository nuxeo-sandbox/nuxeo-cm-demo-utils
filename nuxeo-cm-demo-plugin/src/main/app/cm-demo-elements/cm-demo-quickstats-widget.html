<!--
@license
(C) Copyright 2015 Nuxeo SA (http://nuxeo.com/) and others.

Licensed under the Apache License, Version 2.0 (the "License"); you may
not use this file except in compliance with the License. You may obtain
a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.

Contributors:
  Joshua Fletcher <jfletcher@nuxeo.com>
-->
<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-card/paper-card.html">
<link rel="import" href="../paper-progress/paper-progress.html">
<!--
An element for displaying the progress of claims in the CM demo.

Example:

    <cm-demo-quickstats-widget>
    </cm-demo-quickstats-widget>

### Styling

The following custom properties and mixins are available for styling:

Custom property | Description | Default
----------------|-------------|----------
`--cm-demo-quickstats-widget` | Mixin applied to the element | `{}`

@group Nuxeo CM Demo Elements
@element cm-demo-quickstats-widget
@demo demo/demo-cm-demo-quickstats-widget.html
-->
<dom-module id="cm-demo-quickstats-widget">

  <template>

    <style>
      :host {
        @apply(--cm-demo-quickstats-widget);
      }

      paper-card {
        --paper-card-header-color: #ffffff;
        --paper-card-header: {
          background: #236ba5;
        }
      }

      .claim-total {
        text-align: center;
      }

      .claim-state {
        margin-bottom: 10px;
        display: flex;
        flex-direction: column;
      }

      .progress-bar {
        display: table;
      }

      .count {
        padding-left: 5px;
        font-size: smaller;
        display: table-cell;
        vertical-align: middle;
      }

      paper-progress {
        --paper-progress-height: 20px;
        display: table-cell;
        vertical-align: middle;
      }

      .progress-on-schedule {
        --paper-progress-active-color: #00a300;
      }

      .progress-past-due {
        --paper-progress-active-color: #cc0000;
      }

      .progress-done {
        --paper-progress-active-color: #007a7a;
      }

    </style>

    <nuxeo-connection></nuxeo-connection>

    <nuxeo-page-provider auto provider="IC-FacetedSearchMain" query="[[_query(claimState)]]" page-size="1" current-page="{{claims}}" enrichers="preview, documentURL, driveEditURL"></nuxeo-page-provider>

    <paper-card heading="Claims Progress" class="justified">
      <div class="card-content">
        <div class="claim-state">
          <div>On Schedule</div>
          <div class="progress-bar">
            <paper-progress value="40" class="progress-on-schedule"></paper-progress>
            <div class="count ">80 (40%)</div>
          </div>
        </div>
        <div class="claim-state">
          <div>Past Due</div>
          <div class="progress-bar">
            <paper-progress value="10" class="progress-past-due"></paper-progress>
            <div class="count ">20 (10%)</div>
          </div>
        </div>
        <div class="claim-state">
          <div> Done</div>
          <div class="progress-bar">
            <paper-progress value="50" class="progress-done"></paper-progress>
            <div class="count ">100 (50%)</div>
          </div>
        </div>
        <div class="claim-total">Total Claims 200</div>
      </div>
    </paper-card>

  </template>

  <script>
    Polymer({
      is: 'cm-demo-quickstats-widget',

      properties: {
        claimState: {
          type: String
        }
      },

      _query: function(claimState) {
        var query = this._genericFilter("InsuranceClaim");

        return query;
      },

      _genericFilter: function(type) {
        var query = "SELECT * FROM " + type +
          " WHERE ecm:currentLifeCycleState != 'deleted' " +
          " AND ecm:isCheckedInVersion = 0 " +
          " AND ecm:mixinType != 'HiddenInNavigation' ";
        return query;
      },

      _debug: function(data) {
        debugger;
      }
    });

  </script>

</dom-module>
